function validEmail(a){return-1!=a.indexOf("@")&&-1!=a.indexOf(".")}function saveComment(a,b,c,d){var e=db.ref().child("comentarios").push().key,f=c.getDate()<10?"0"+c.getDate():c.getDate(),g=c.getMonth()+1<10?"0"+(c.getMonth()+1):c.getMonth()+1,h=c.getHours()<10?"0"+c.getHours():c.getHours(),i=c.getMinutes()<10?"0"+c.getMinutes():c.getMinutes(),j=f+"/"+g+"/"+c.getFullYear(),k=h+":"+i;db.ref("comentarios/"+namePost+"/"+e).set({nome:a,email:d,comentario:b,data:j+" "+k});var l=$('<span class="center-align">Comentário registrado!<br>Obrigado.</span>');Materialize.toast(l,7e3),resetForm()}function resetForm(){$("form")[0].reset()}const nome=$("#nome"),email=$("#email"),comentario=$("#comentario"),dataAtual=new Date,db=firebase.database(),namePost=$("#postname").val();$("form").submit(function(a){var b,c,d,e;""==nome.val()||nome.val().length<3?(nome.removeClass("validate").addClass("invalid"),email.removeClass("invalid").addClass("validate"),comentario.removeClass("invalid").addClass("validate"),nome.focus()):""!=email.val()||validEmail(email.val())?""==comentario.val()?(nome.removeClass("invalid").addClass("validate"),email.removeClass("invalid").addClass("validate"),comentario.removeClass("validate").addClass("invalid"),comentario.focus()):(b=nome.val(),c=comentario.val(),d=new Date,e=email.val(),comentario.removeClass("invalid").addClass("valid"),nome.removeClass("invalid").addClass("valid"),email.removeClass("invalid").addClass("valid"),saveComment(b,c,d,e)):(nome.removeClass("invalid").addClass("validate"),email.removeClass("validate").addClass("invalid"),comentario.removeClass("invalid").addClass("validate"),email.focus()),a.preventDefault()});var commentsRef=db.ref("comentarios/"+namePost).on("value",function(a){$(".loading").hide();var b=[],c=0;for(var d in a.val())b[c]=d,c++;if($("#comentarios").empty(),null==a.val())$("#comentarios").append('<h5 class="center-align">Seja o primeiro a comentar esta publicação.</h5>');else{var e=b.length-1;for(c=e;c>=0;c--){db.ref("comentarios/"+namePost+"/"+b[c]).on("value",function(a){$("#comentarios").append('<div class="card"><div class="card-content"><span class="card-title"><b>'+a.val().nome+'</b> <span class="info">disse:</span></span><span class="info">'+a.val().data+'</span><p class="flow-text">'+a.val().comentario+"</p></div></div>")})}}});